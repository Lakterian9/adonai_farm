const e=new class{constructor(){this.connectionType=this.getConnectionType(),this.isSlowConnection=this.checkSlowConnection(),this.prefersReducedMotion=this.checkReducedMotion(),this.isTouchDevice=this.checkTouchDevice(),this.isOffline=!navigator.onLine,this.setupConnectionListeners(),this.setupVisibilityListeners()}getConnectionType(){return"connection"in navigator?{effectiveType:navigator.connection.effectiveType,downlink:navigator.connection.downlink,rtt:navigator.connection.rtt,saveData:navigator.connection.saveData}:null}checkSlowConnection(){return!!this.connectionType&&(["slow-2g","2g"].includes(this.connectionType.effectiveType)||this.connectionType.saveData||this.connectionType.downlink<1.5||this.connectionType.rtt>300)}checkReducedMotion(){return window.matchMedia("(prefers-reduced-motion: reduce)").matches}checkTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}setupConnectionListeners(){window.addEventListener("online",()=>{this.isOffline=!1,this.notifyConnectionChange("online")}),window.addEventListener("offline",()=>{this.isOffline=!0,this.notifyConnectionChange("offline")}),"connection"in navigator&&navigator.connection.addEventListener("change",()=>{this.connectionType=this.getConnectionType(),this.isSlowConnection=this.checkSlowConnection(),this.notifyConnectionChange("connection-change")})}setupVisibilityListeners(){document.addEventListener("visibilitychange",()=>{document.hidden?this.pauseNonEssentialOperations():this.resumeOperations()})}notifyConnectionChange(e){const t=new CustomEvent("connectionchange",{detail:{type:e,isOffline:this.isOffline,isSlowConnection:this.isSlowConnection,connectionType:this.connectionType}});window.dispatchEvent(t)}pauseNonEssentialOperations(){document.querySelectorAll('img[loading="lazy"]').forEach(e=>{e.dataset.src&&!e.src.includes(e.dataset.src)&&(e.dataset.paused="true")}),this.prefersReducedMotion||document.body.classList.add("paused-animations")}resumeOperations(){document.querySelectorAll('img[data-paused="true"]').forEach(e=>{delete e.dataset.paused,e.dataset.src&&(e.src=e.dataset.src)}),document.body.classList.remove("paused-animations")}getOptimizedImageUrl(e,t={}){const{width:i=800,height:n=600,quality:a=80,format:o="webp"}=t;return this.isSlowConnection||this.connectionType?.saveData?this.getLowQualityImageUrl(e,{width:Math.min(i,400),height:Math.min(n,300),quality:60,format:"jpeg"}):this.getHighQualityImageUrl(e,{width:i,height:n,quality:a,format:o})}getLowQualityImageUrl(e,t){return`${e}?${new URLSearchParams({w:t.width,h:t.height,q:t.quality,f:t.format}).toString()}`}getHighQualityImageUrl(e,t){return`${e}?${new URLSearchParams({w:t.width,h:t.height,q:t.quality,f:t.format}).toString()}`}preloadCriticalImages(e){this.isSlowConnection||this.isOffline||e.forEach(e=>{const t=document.createElement("link");t.rel="preload",t.as="image",t.href=e,document.head.appendChild(t)})}setupLazyLoading(e="img[data-src]",t={}){const i={threshold:.1,rootMargin:"50px",...t},n=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const t=e.target,i=t.dataset.src;if(i){const e=this.getOptimizedImageUrl(i,{width:t.dataset.width||800,height:t.dataset.height||600});t.src=e,t.classList.remove("lazy"),t.classList.add("loaded"),n.unobserve(t)}}})},i);return document.querySelectorAll(e).forEach(e=>n.observe(e)),n}showConnectionStatus(){const e=document.querySelector(".connection-indicator");e&&e.remove(),this.isOffline?this.showOfflineIndicator():this.isSlowConnection&&this.showSlowConnectionIndicator()}showOfflineIndicator(){const e=document.createElement("div");e.className="connection-indicator offline-indicator",e.innerHTML="\n      <span>üì°</span>\n      <span>You're offline. Some features may not work.</span>\n    ",document.body.appendChild(e),setTimeout(()=>{e.parentNode&&e.remove()},5e3)}showSlowConnectionIndicator(){const e=document.createElement("div");e.className="connection-indicator slow-connection-indicator",e.innerHTML="\n      <span>üêå</span>\n      <span>Slow connection detected. Images may load slowly.</span>\n    ",document.body.appendChild(e),setTimeout(()=>{e.parentNode&&e.remove()},3e3)}enableDataSaverMode(){document.body.classList.add("data-saver-mode");document.querySelectorAll("video[autoplay]").forEach(e=>{e.removeAttribute("autoplay"),e.pause()});document.querySelectorAll("img").forEach(e=>{if(e.dataset.src){const t=this.getLowQualityImageUrl(e.dataset.src,{width:400,height:300,quality:50});e.dataset.src=t}})}disableDataSaverMode(){document.body.classList.remove("data-saver-mode")}getDeviceCapabilities(){return{isTouchDevice:this.isTouchDevice,prefersReducedMotion:this.prefersReducedMotion,isSlowConnection:this.isSlowConnection,isOffline:this.isOffline,connectionType:this.connectionType,screenSize:{width:window.screen.width,height:window.screen.height},viewportSize:{width:window.innerWidth,height:window.innerHeight},devicePixelRatio:window.devicePixelRatio||1}}optimizeForMobile(){window.innerWidth<=768&&(document.body.classList.add("mobile-optimized"),this.prefersReducedMotion||document.documentElement.style.setProperty("--animation-duration","0.2s"),document.body.classList.add("touch-enabled"),document.body.style.webkitOverflowScrolling="touch")}init(){this.showConnectionStatus(),this.optimizeForMobile(),this.setupLazyLoading(),(this.isSlowConnection||this.connectionType?.saveData)&&this.enableDataSaverMode()}};function t(e,t={}){const{maxWidth:i=1200,maxHeight:n=800,quality:a=.8,format:o="image/jpeg"}=t;return new Promise((t,s)=>{const r=document.createElement("canvas"),c=r.getContext("2d"),d=new Image;d.onload=()=>{let{width:e,height:s}=d;e>i&&(s=s*i/e,e=i),s>n&&(e=e*n/s,s=n),r.width=e,r.height=s,c.drawImage(d,0,0,e,s),r.toBlob(t,o,a)},d.onerror=s,d.src=URL.createObjectURL(e)})}function i(e,t){const i=t.replace(/\.[^/.]+$/,""),n=t.split(".").pop();return{original:`${e}/${t}`,large:`${e}/${i}_large.${n}`,medium:`${e}/${i}_medium.${n}`,small:`${e}/${i}_small.${n}`,thumbnail:`${e}/${i}_thumb.${n}`,srcset:[`${e}/${i}_small.${n} 400w`,`${e}/${i}_medium.${n} 800w`,`${e}/${i}_large.${n} 1200w`,`${e}/${t} 1600w`].join(", "),sizes:"(max-width: 480px) 400px, (max-width: 768px) 800px, (max-width: 1200px) 1200px, 1600px"}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{e.init()}):e.init();function n(e,t){const i=Array.isArray(t)?t:[t];let n=0;e.onerror=()=>{if(n<i.length){const t=i[n];e.src!==t&&(e.src=t,n++)}else e.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjVmNWY1IiBzdHJva2U9IiNkZGQiIHN0cm9rZS13aWR0aD0iMiIvPjx0ZXh0IHg9IjUwJSIgeT0iNDAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTgiIGZpbGw9IiM5OTkiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5BZG9uYWkgRmFybTwvdGV4dD48dGV4dCB4PSI1MCUiIHk9IjYwJSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiBmaWxsPSIjYmJiIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkeT0iLjNlbSI+SW1hZ2UgTm90IEF2YWlsYWJsZTwvdGV4dD48L3N2Zz4=",e.classList.add("image-failed")}}const a=new class{constructor(e={}){this.options={rootMargin:"50px",threshold:.1,...e},this.observer=new IntersectionObserver(this.handleIntersection.bind(this),this.options)}handleIntersection(e){e.forEach(e=>{if(e.isIntersecting){const t=e.target;this.loadImage(t),this.observer.unobserve(t)}})}loadImage(e){const t=e.dataset.src,i=e.dataset.srcset;t&&(e.src=t),i&&(e.srcset=i),e.classList.add("loaded"),e.removeAttribute("data-src"),e.removeAttribute("data-srcset")}observe(e){this.observer.observe(e)}disconnect(){this.observer.disconnect()}};function o(){document.querySelectorAll("img[data-src]").forEach(e=>a.observe(e))}function s(){"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(e=>{}).catch(e=>{})}"undefined"!=typeof window&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{o(),s()}):(o(),s()));const r={name:"Adonai Farm",description:"Modern livestock farm in Kericho, Kenya specializing in sustainable farming, quality breeding, and premium agricultural products",url:"https://adonaifarm.co.ke",logo:"https://adonaifarm.co.ke/images/logo.png",image:"https://adonaifarm.co.ke/images/hero-farm.jpg",foundingDate:"2020",address:{streetAddress:"Chepsir",addressLocality:"Kericho",addressRegion:"Kericho County",addressCountry:"Kenya",postalCode:"20200"},contact:{telephone:"+254722759217",email:"info@adonaifarm.co.ke"},openingHours:["Mo-Fr 07:00-18:00","Sa 08:00-16:00"],services:["Livestock Breeding","Farm Tours","Agricultural Consulting","Premium Meat Products","Dairy Products","Veterinary Support"],keywords:["livestock farm Kenya","Kericho farm","sustainable farming","livestock breeding","farm tours Kenya","agricultural consulting","premium beef Kenya","dairy products Kericho","modern farming technology","animal welfare farm"]},c=e=>{const{title:t,description:i,keywords:n=[],image:a,url:o,type:s="website",publishedTime:c,modifiedTime:d,author:l}=e,m=t?`${t} | ${r.name}`:r.name,h=i||r.description,g=o?`${r.url}${o}`:r.url,u=a?`${r.url}${a}`:r.image;return{title:m,description:h,keywords:[...r.keywords,...n].join(", "),ogTitle:m,ogDescription:h,ogImage:u,ogUrl:g,ogType:s,ogSiteName:r.name,twitterCard:"summary_large_image",twitterTitle:m,twitterDescription:h,twitterImage:u,twitterSite:"@adonaifarm",canonical:g,robots:"index, follow",language:"en-KE",author:l||r.name,publishedTime:c,modifiedTime:d,geoRegion:"KE-30",geoPlacename:"Kericho, Kenya",geoPosition:"-0.3676,35.2833"}},d=(e,t={})=>{const i={"@context":"https://schema.org","@type":"Organization",name:r.name,description:r.description,url:r.url,logo:r.logo,image:r.image,foundingDate:r.foundingDate,address:{"@type":"PostalAddress",streetAddress:r.address.streetAddress,addressLocality:r.address.addressLocality,addressRegion:r.address.addressRegion,addressCountry:r.address.addressCountry,postalCode:r.address.postalCode},contactPoint:{"@type":"ContactPoint",telephone:r.contact.telephone,email:r.contact.email,contactType:"customer service"},openingHoursSpecification:r.openingHours.map(e=>({"@type":"OpeningHoursSpecification",opens:e.split(" ")[1].split("-")[0],closes:e.split(" ")[1].split("-")[1],dayOfWeek:e.split(" ")[0]})),sameAs:[]};switch(e){case"homepage":return{...i,"@type":["Organization","LocalBusiness"],priceRange:"$$",hasOfferCatalog:{"@type":"OfferCatalog",name:"Farm Services",itemListElement:r.services.map((e,t)=>({"@type":"Offer",itemOffered:{"@type":"Service",name:e}}))}};case"about":return{...i,knowsAbout:["Livestock Management","Sustainable Farming","Animal Breeding","Agricultural Technology"]};case"services":return{...i,"@type":["Organization","LocalBusiness"],hasOfferCatalog:{"@type":"OfferCatalog",name:"Farm Services & Products",itemListElement:[{"@type":"Offer",itemOffered:{"@type":"Service",name:"Livestock Breeding",description:"Professional breeding services with genetic optimization"}},{"@type":"Offer",itemOffered:{"@type":"Service",name:"Farm Tours",description:"Educational farm visits and tours",offers:{"@type":"Offer",price:"500",priceCurrency:"KES"}}},{"@type":"Offer",itemOffered:{"@type":"Product",name:"Premium Livestock Products",description:"High-quality meat and dairy products"}}]}};case"contact":return{...i,contactPoint:[{"@type":"ContactPoint",telephone:r.contact.telephone,email:r.contact.email,contactType:"customer service",availableLanguage:["English","Swahili"]}]};case"animals":return{...i,hasOfferCatalog:{"@type":"OfferCatalog",name:"Livestock",itemListElement:t.animals?.map(e=>({"@type":"Offer",itemOffered:{"@type":"Product",name:e.name,description:e.description,category:"Livestock"}}))||[]}};case"gallery":return{...i,photo:t.images?.map(e=>({"@type":"ImageObject",url:`${r.url}${e.url}`,caption:e.caption||`${r.name} - ${e.category}`}))||[]};default:return i}},l=e=>({"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:e.map((e,t)=>({"@type":"ListItem",position:t+1,name:e.name,item:`${r.url}${e.url}`}))});const m=new class{constructor(){this.notifications=this.loadNotifications(),this.settings=this.loadSettings()}loadNotifications(){const e=localStorage.getItem("adonai_notifications");return e?JSON.parse(e):[]}loadSettings(){const e=localStorage.getItem("adonai_notification_settings");return e?JSON.parse(e):{maintenanceReminders:!0,farmEvents:!0,systemAlerts:!0,emailNotifications:!1,reminderDays:7,soundEnabled:!0}}saveNotifications(){localStorage.setItem("adonai_notifications",JSON.stringify(this.notifications))}saveSettings(){localStorage.setItem("adonai_notification_settings",JSON.stringify(this.settings))}createNotification(e,t,i,n="medium",a={}){const o={id:Date.now()+Math.random(),type:e,title:t,message:i,priority:n,data:a,timestamp:(new Date).toISOString(),read:!1,dismissed:!1};return this.notifications.unshift(o),this.saveNotifications(),this.settings.soundEnabled&&"Notification"in window&&this.showBrowserNotification(o),o}async showBrowserNotification(e){if("granted"===Notification.permission)new Notification(e.title,{body:e.message,icon:"/favicon.ico",tag:e.id});else if("denied"!==Notification.permission){"granted"===await Notification.requestPermission()&&new Notification(e.title,{body:e.message,icon:"/favicon.ico",tag:e.id})}}checkMaintenanceReminders(){if(!this.settings.maintenanceReminders)return;const e=JSON.parse(localStorage.getItem("adonai_infrastructure")||"[]"),t=new Date;this.settings.reminderDays,e.forEach(e=>{if("vehicle"===e.category||"equipment"===e.category){if(e.usage_hours&&e.usage_hours>0){const t=this.getMaintenanceInterval(e.type),i=t-e.usage_hours%t;if(i<=50){this.notifications.find(t=>"maintenance"===t.type&&t.data.itemId===e.id&&!t.dismissed)||this.createNotification("maintenance",`Maintenance Due: ${e.name}`,`${e.name} needs maintenance in ${i} hours of operation`,"high",{itemId:e.id,itemType:e.type,hoursUntil:i})}}if("Maintenance"===e.status){this.notifications.find(t=>"maintenance"===t.type&&t.data.itemId===e.id&&"in_maintenance"===t.data.status&&!t.dismissed)||this.createNotification("maintenance",`Item Under Maintenance: ${e.name}`,`${e.name} is currently under maintenance and unavailable`,"medium",{itemId:e.id,itemType:e.type,status:"in_maintenance"})}}if("building"===e.category&&e.construction_date){const i=new Date(e.construction_date);if((t-i)/315576e5>=1){const n=`building_inspection_${e.id}`,a=localStorage.getItem(n),o=a?new Date(a):i,s=(t-o)/864e5;if(s>=365-this.settings.reminderDays){this.notifications.find(t=>"maintenance"===t.type&&t.data.itemId===e.id&&"annual"===t.data.inspectionType&&!t.dismissed)||this.createNotification("maintenance",`Annual Inspection Due: ${e.name}`,`${e.name} requires annual inspection (${Math.ceil(365-s)} days remaining)`,"medium",{itemId:e.id,itemType:e.type,inspectionType:"annual"})}}}})}getMaintenanceInterval(e){return{Tractor:250,Truck:300,Pickup:400,Equipment:200,Machinery:150,Implements:500,Tools:1e3}[e]||250}checkFarmEvents(){if(!this.settings.farmEvents)return;const e=JSON.parse(localStorage.getItem("adonai_animals")||"[]"),t=new Date;e.forEach(e=>{if(e.breeding_date){const i=new Date(e.breeding_date),n=this.getGestationPeriod(e.species),a=new Date(i.getTime()+24*n*60*60*1e3),o=Math.ceil((a-t)/864e5);if(o<=this.settings.reminderDays&&o>0){this.notifications.find(t=>"event"===t.type&&t.data.animalId===e.id&&"breeding_due"===t.data.eventType&&!t.dismissed)||this.createNotification("event",`Birth Expected: ${e.name}`,`${e.name} is expected to give birth in ${o} days`,"high",{animalId:e.id,eventType:"breeding_due",daysUntil:o})}}if(e.last_vaccination){const i=new Date(e.last_vaccination),n=365,a=new Date(i.getTime()+24*n*60*60*1e3),o=Math.ceil((a-t)/864e5);if(o<=this.settings.reminderDays&&o>0){this.notifications.find(t=>"event"===t.type&&t.data.animalId===e.id&&"vaccination_due"===t.data.eventType&&!t.dismissed)||this.createNotification("event",`Vaccination Due: ${e.name}`,`${e.name} needs vaccination in ${o} days`,"medium",{animalId:e.id,eventType:"vaccination_due",daysUntil:o})}}})}getGestationPeriod(e){return{Cattle:283,Sheep:147,Goat:150,Pig:114,Horse:340,Chicken:21,Duck:28,Turkey:28}[e]||283}checkSystemHealth(){if(!this.settings.systemAlerts)return;const e=this.getStorageUsage();if(e.percentage>80){this.notifications.find(e=>"system"===e.type&&"storage_high"===e.data.alertType&&!e.dismissed)||this.createNotification("system","Storage Usage High",`Local storage is ${e.percentage}% full (${e.used}/${e.total}). Consider backing up and cleaning data.`,"medium",{alertType:"storage_high",usage:e.percentage})}this.checkDataIntegrity()}getStorageUsage(){let e=0,t=0;for(let n in localStorage)localStorage.hasOwnProperty(n)&&(t+=localStorage[n].length);e=5242880;const i=Math.round(t/e*100);return{used:this.formatBytes(t),total:this.formatBytes(e),percentage:i}}formatBytes(e){if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]}checkDataIntegrity(){let e=[];["adonai_animals","adonai_workers","adonai_infrastructure","adonai_users"].forEach(t=>{try{const e=localStorage.getItem(t);e&&JSON.parse(e)}catch(i){e.push(t)}}),e.length>0&&this.createNotification("system","Data Corruption Detected",`Corrupted data detected in: ${e.join(", ")}. Please restore from backup.`,"critical",{alertType:"data_corruption",corruptedKeys:e})}markAsRead(e){const t=this.notifications.find(t=>t.id===e);t&&(t.read=!0,this.saveNotifications())}dismissNotification(e){const t=this.notifications.find(t=>t.id===e);t&&(t.dismissed=!0,this.saveNotifications())}getActiveNotifications(){return this.notifications.filter(e=>!e.dismissed)}getUnreadNotifications(){return this.notifications.filter(e=>!e.read&&!e.dismissed)}getNotificationsByType(e){return this.notifications.filter(t=>t.type===e&&!t.dismissed)}getNotificationsByPriority(e){return this.notifications.filter(t=>t.priority===e&&!t.dismissed)}updateSettings(e){this.settings={...this.settings,...e},this.saveSettings()}runAllChecks(){this.checkMaintenanceReminders(),this.checkFarmEvents(),this.checkSystemHealth()}clearOldNotifications(){const e=new Date(Date.now()-2592e6);this.notifications=this.notifications.filter(t=>new Date(t.timestamp)>e||!t.dismissed),this.saveNotifications()}getStatistics(){return{total:this.notifications.length,unread:this.getUnreadNotifications().length,byType:{maintenance:this.getNotificationsByType("maintenance").length,event:this.getNotificationsByType("event").length,system:this.getNotificationsByType("system").length,reminder:this.getNotificationsByType("reminder").length},byPriority:{critical:this.getNotificationsByPriority("critical").length,high:this.getNotificationsByPriority("high").length,medium:this.getNotificationsByPriority("medium").length,low:this.getNotificationsByPriority("low").length}}}};setInterval(()=>{m.runAllChecks(),m.clearOldNotifications()},36e5),m.runAllChecks();export{c as a,d as b,l as c,a as d,t as e,i as g,n as h,m as n};
